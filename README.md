# DNS lab with vpn

This creates an onprem vnet with Cisco CSR1000v connected to a hub vnet vpn gateway and a spoke vnet attached to the hub. A private DNS zone (dnslab.com) is created and linked to the hub vnet with auto-registration and linked to the spoke vnet without it. An A record for the spoke VM is created while the hub VM gets autocreated. A private DNS resolver inbound endpoint is created in the hub vnet and the onprem vnet uses this for DNS. VM's are created in all 3 vnets, onprem VM can resolve the azure VM's by hostname (hubvm.dnslab.com and spokevm.dnslab.com). You'll be prompted for the resource group name, location where you want the resources created, your public ip, and username and password to use for the VM's and NVA. NSG's are placed on the default subnets of each vnet allowing RDP access from your public ip. This also creates a logic app that will delete the resource group in 24hrs. The topology will look something like this:
![DNSlab-PRwithinboundEPandVPN](https://github.com/quiveringbacon/DNSlabwithvpn/assets/128983862/f2a21db5-df4a-444b-94e5-75cefe0f0f27)

You can run Terraform right from the Azure cloud shell by cloning this git repository with "git clone https://github.com/quiveringbacon/DNSlabwithvpn.git ./terraform". Then, "cd terraform" then, "terraform init" and finally "terraform apply -auto-approve" to deploy.
